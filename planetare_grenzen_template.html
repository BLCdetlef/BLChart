<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRUCHLAST - Planetare Grenzen Template</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .planetary-boundaries {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .boundary-card {
            border: 2px solid;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .boundary-card:hover {
            transform: scale(1.05);
        }
        
        .boundary-card.selected {
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }
        
        .boundary-symbol {
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        .boundary-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .boundary-color {
            font-size: 0.9em;
            color: #666;
        }
        
        /* Farben f√ºr die planetaren Grenzen */
        .klimawandel { border-color: #FFFF00; background-color: #FFFF0020; }
        .klimawandel .boundary-symbol { color: #FFFF00; }
        
        .neue-substanzen { border-color: #FF0000; background-color: #FF000020; }
        .neue-substanzen .boundary-symbol { color: #FF0000; }
        
        .biodiversitaet { border-color: #00FF00; background-color: #00FF0020; }
        .biodiversitaet .boundary-symbol { color: #00FF00; }
        
        .suesswassernutzung { border-color: #0000FF; background-color: #0000FF20; }
        .suesswassernutzung .boundary-symbol { color: #0000FF; }
        
        .landnutzung { border-color: #8B4513; background-color: #8B451320; }
        .landnutzung .boundary-symbol { color: #8B4513; }
        
        .ozeanversauerung { border-color: #00FFFF; background-color: #00FFFF20; }
        .ozeanversauerung .boundary-symbol { color: #00FFFF; }
        
        .ozonloch { border-color: #800080; background-color: #80008020; }
        .ozonloch .boundary-symbol { color: #800080; }
        
        .aerosole { border-color: #808080; background-color: #80808020; }
        .aerosole .boundary-symbol { color: #808080; }
        
        .stickstoffkreislauf { border-color: #FFA500; background-color: #FFA50020; }
        .stickstoffkreislauf .boundary-symbol { color: #FFA500; }
        
        .planetare-gesundheit { border-color: #FF69B4; background-color: #FF69B420; }
        .planetare-gesundheit .boundary-symbol { color: #FF69B4; }
        
        .rohstoffe-ressourcen { border-color: #C0C0C0; background-color: #C0C0C020; }
        .rohstoffe-ressourcen .boundary-symbol { color: #C0C0C0; }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            background-color: #e0e0e0;
            border: none;
            cursor: pointer;
            margin-right: 5px;
        }
        
        .tab.active {
            background-color: #007bff;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        
        .validation-ok {
            background-color: #d4edda;
            color: #155724;
        }
        
        .validation-error {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .metadata-section {
            margin-bottom: 20px;
        }
        
        .metadata-section h3 {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        
        .formula-display {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        
        .export-section {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        .selected-boundary {
            background-color: #e7f3ff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>BRUCHLAST - Planetare Grenzen Template</h1>
        
        <div class="planetary-boundaries">
            <div class="boundary-card klimawandel" onclick="selectBoundary('klimawandel', 'GELB', '‚òÄÔ∏è', 'Klimawandel')">
                <div class="boundary-symbol">‚òÄÔ∏è</div>
                <div class="boundary-name">Klimawandel</div>
                <div class="boundary-color">GELB (#FFFF00)</div>
            </div>
            
            <div class="boundary-card neue-substanzen" onclick="selectBoundary('neue-substanzen', 'ROT', '‚öóÔ∏è', 'Neue Substanzen')">
                <div class="boundary-symbol">‚öóÔ∏è</div>
                <div class="boundary-name">Neue Substanzen</div>
                <div class="boundary-color">ROT (#FF0000)</div>
            </div>
            
            <div class="boundary-card biodiversitaet" onclick="selectBoundary('biodiversitaet', 'GR√úN', 'üåø', 'Biodiversit√§t')">
                <div class="boundary-symbol">üåø</div>
                <div class="boundary-name">Biodiversit√§t</div>
                <div class="boundary-color">GR√úN (#00FF00)</div>
            </div>
            
            <div class="boundary-card suesswassernutzung" onclick="selectBoundary('suesswassernutzung', 'BLAU', 'üíß', 'S√º√üwassernutzung')">
                <div class="boundary-symbol">üíß</div>
                <div class="boundary-name">S√º√üwassernutzung</div>
                <div class="boundary-color">BLAU (#0000FF)</div>
            </div>
            
            <div class="boundary-card landnutzung" onclick="selectBoundary('landnutzung', 'BRAUN', 'üåç', 'Landnutzung')">
                <div class="boundary-symbol">üåç</div>
                <div class="boundary-name">Landnutzung</div>
                <div class="boundary-color">BRAUN (#8B4513)</div>
            </div>
            
            <div class="boundary-card ozeanversauerung" onclick="selectBoundary('ozeanversauerung', 'T√úRKIS', 'üêö', 'Ozeanversauerung')">
                <div class="boundary-symbol">üêö</div>
                <div class="boundary-name">Ozeanversauerung</div>
                <div class="boundary-color">T√úRKIS (#00FFFF)</div>
            </div>
            
            <div class="boundary-card ozonloch" onclick="selectBoundary('ozonloch', 'LILA', 'üõ°Ô∏è', 'Ozonloch')">
                <div class="boundary-symbol">üõ°Ô∏è</div>
                <div class="boundary-name">Ozonloch</div>
                <div class="boundary-color">LILA (#800080)</div>
            </div>
            
            <div class="boundary-card aerosole" onclick="selectBoundary('aerosole', 'GRAU', '‚òÅÔ∏è', 'Aerosole')">
                <div class="boundary-symbol">‚òÅÔ∏è</div>
                <div class="boundary-name">Aerosole</div>
                <div class="boundary-color">GRAU (#808080)</div>
            </div>
            
            <div class="boundary-card stickstoffkreislauf" onclick="selectBoundary('stickstoffkreislauf', 'ORANGE', 'üå±', 'Stickstoffkreislauf')">
                <div class="boundary-symbol">üå±</div>
                <div class="boundary-name">Stickstoffkreislauf</div>
                <div class="boundary-color">ORANGE (#FFA500)</div>
            </div>
            
            <div class="boundary-card planetare-gesundheit" onclick="selectBoundary('planetare-gesundheit', 'PINK', '‚ù§Ô∏è', 'Planetare Gesundheit')">
                <div class="boundary-symbol">‚ù§Ô∏è</div>
                <div class="boundary-name">Planetare Gesundheit</div>
                <div class="boundary-color">PINK (#FF69B4)</div>
            </div>
            
            <div class="boundary-card rohstoffe-ressourcen" onclick="selectBoundary('rohstoffe-ressourcen', 'SILBER', '‚õèÔ∏è', 'Rohstoffe & Ressourcen')">
                <div class="boundary-symbol">‚õèÔ∏è</div>
                <div class="boundary-name">Rohstoffe & Ressourcen</div>
                <div class="boundary-color">SILBER (#C0C0C0)</div>
            </div>
        </div>
        
        <div id="selectedBoundaryInfo" class="selected-boundary" style="display: none;">
            <h3>Ausgew√§hlte Planetare Grenze</h3>
            <div id="boundaryDetails"></div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('messwerte')">Messwerte</button>
            <button class="tab" onclick="showTab('metadaten')">Metadaten</button>
            <button class="tab" onclick="showTab('anleitung')">Anleitung</button>
        </div>
        
        <!-- Tabellenblatt 1: Messwerte -->
        <div id="messwerte" class="tab-content active">
            <h2>Messwerte und Berechnungen</h2>
            
            <div class="metadata-section">
                <h3>Kurveninformationen</h3>
                <table>
                    <tr>
                        <th>Kurvenname</th>
                        <th>Kurventyp</th>
                        <th>Planetare Grenze</th>
                    </tr>
                    <tr>
                        <td><input type="text" id="kurvenname" placeholder="z.B. U_klimawandel_Temperatur" maxlength="30"></td>
                        <td>
                            <select id="kurventyp">
                                <option value="U">U = Ursache (gestrichelt)</option>
                                <option value="W">W = Wirkung (durchgezogen)</option>
                            </select>
                        </td>
                        <td>
                            <select id="planetareGrenze" onchange="updateColorAndSymbol()">
                                <option value="">Bitte w√§hlen...</option>
                                <option value="klimawandel">Klimawandel (GELB)</option>
                                <option value="neue-substanzen">Neue Substanzen (ROT)</option>
                                <option value="biodiversitaet">Biodiversit√§t (GR√úN)</option>
                                <option value="suesswassernutzung">S√º√üwassernutzung (BLAU)</option>
                                <option value="landnutzung">Landnutzung (BRAUN)</option>
                                <option value="ozeanversauerung">Ozeanversauerung (T√úRKIS)</option>
                                <option value="ozonloch">Ozonloch (LILA)</option>
                                <option value="aerosole">Aerosole (GRAU)</option>
                                <option value="stickstoffkreislauf">Stickstoffkreislauf (ORANGE)</option>
                                <option value="planetare-gesundheit">Planetare Gesundheit (PINK)</option>
                                <option value="rohstoffe-ressourcen">Rohstoffe & Ressourcen (SILBER)</option>
                            </select>
                        </td>
                    </tr>
                </table>
            </div>
            
            <div class="metadata-section">
                <h3>Grenzwerte</h3>
                <table>
                    <tr>
                        <th>Unterer Grenzwert</th>
                        <th>Oberer Grenzwert</th>
                    </tr>
                    <tr>
                        <td><input type="number" id="untererGrenzwert" step="0.01"></td>
                        <td><input type="number" id="obererGrenzwert" step="0.01"></td>
                    </tr>
                </table>
            </div>
            
            <div class="metadata-section">
                <h3>Messwerte (mindestens 5 erforderlich)</h3>
                <table id="messwerteTable">
                    <thead>
                        <tr>
                            <th>Jahr</th>
                            <th>Messwert</th>
                            <th>Prozent (automatisch)</th>
                            <th>Validierung</th>
                        </tr>
                    </thead>
                    <tbody id="messwerteBody">
                        <!-- Wird durch JavaScript gef√ºllt -->
                    </tbody>
                </table>
            </div>
            
            <div class="formula-display">
                <strong>Formel:</strong> Prozent = ((Messwert - Unterer_Grenzwert) / (Oberer_Grenzwert - Unterer_Grenzwert)) * 100
            </div>
        </div>
        
        <!-- Tabellenblatt 2: Metadaten -->
        <div id="metadaten" class="tab-content">
            <h2>Metadaten und Quellenangaben</h2>
            
            <div class="metadata-section">
                <h3>Kurvenbeschreibung</h3>
                <textarea id="kurvenbeschreibung" rows="4" style="width: 100%; padding: 10px;" 
                    placeholder="Detaillierte Beschreibung der Kurve und Messwerte..."></textarea>
            </div>
            
            <div class="metadata-section">
                <h3>Quellenangaben</h3>
                <table>
                    <tr>
                        <th>Autoren</th>
                        <td><input type="text" id="autoren" placeholder="Namen der Autoren"></td>
                    </tr>
                    <tr>
                        <th>Ver√∂ffentlichungsdatum</th>
                        <td><input type="date" id="veroeffentlichungsdatum"></td>
                    </tr>
                    <tr>
                        <th>Ver√∂ffentlichungsort</th>
                        <td><input type="text" id="veroeffentlichungsort" placeholder="Zeitschrift, Konferenz, etc."></td>
                    </tr>
                    <tr>
                        <th>Internetlink</th>
                        <td><input type="url" id="internetlink" placeholder="DOI, URL zum Paper"></td>
                    </tr>
                    <tr>
                        <th>Zus√§tzliche Informationen</th>
                        <td><textarea id="zusatzinfo" rows="3" style="width: 100%; padding: 5px;" 
                            placeholder="Weitere relevante Details..."></textarea></td>
                    </tr>
                </table>
            </div>
        </div>
        
        <!-- Tabellenblatt 3: Anleitung -->
        <div id="anleitung" class="tab-content">
            <h2>Anleitung und Regeln</h2>
            
            <div class="metadata-section">
                <h3>Planetare Grenzen - Farben & Symbole</h3>
                <table>
                    <tr>
                        <th>Grenze</th>
                        <th>Symbol</th>
                        <th>Farbe</th>
                        <th>Hex-Code</th>
                    </tr>
                    <tr>
                        <td>Klimawandel</td>
                        <td>‚òÄÔ∏è</td>
                        <td style="background-color: #FFFF00;">GELB</td>
                        <td>#FFFF00</td>
                    </tr>
                    <tr>
                        <td>Neue Substanzen</td>
                        <td>‚öóÔ∏è</td>
                        <td style="background-color: #FF0000; color: white;">ROT</td>
                        <td>#FF0000</td>
                    </tr>
                    <tr>
                        <td>Biodiversit√§t</td>
                        <td>üåø</td>
                        <td style="background-color: #00FF00;">GR√úN</td>
                        <td>#00FF00</td>
                    </tr>
                    <tr>
                        <td>S√º√üwassernutzung</td>
                        <td>üíß</td>
                        <td style="background-color: #0000FF; color: white;">BLAU</td>
                        <td>#0000FF</td>
                    </tr>
                    <tr>
                        <td>Landnutzung</td>
                        <td>üåç</td>
                        <td style="background-color: #8B4513; color: white;">BRAUN</td>
                        <td>#8B4513</td>
                    </tr>
                    <tr>
                        <td>Ozeanversauerung</td>
                        <td>üêö</td>
                        <td style="background-color: #00FFFF;">T√úRKIS</td>
                        <td>#00FFFF</td>
                    </tr>
                    <tr>
                        <td>Ozonloch</td>
                        <td>üõ°Ô∏è</td>
                        <td style="background-color: #800080; color: white;">LILA</td>
                        <td>#800080</td>
                    </tr>
                    <tr>
                        <td>Aerosole</td>
                        <td>‚òÅÔ∏è</td>
                        <td style="background-color: #808080; color: white;">GRAU</td>
                        <td>#808080</td>
                    </tr>
                    <tr>
                        <td>Stickstoffkreislauf</td>
                        <td>üå±</td>
                        <td style="background-color: #FFA500;">ORANGE</td>
                        <td>#FFA500</td>
                    </tr>
                    <tr>
                        <td>Planetare Gesundheit</td>
                        <td>‚ù§Ô∏è</td>
                        <td style="background-color: #FF69B4;">PINK</td>
                        <td>#FF69B4</td>
                    </tr>
                    <tr>
                        <td>Rohstoffe & Ressourcen</td>
                        <td>‚õèÔ∏è</td>
                        <td style="background-color: #C0C0C0;">SILBER</td>
                        <td>#C0C0C0</td>
                    </tr>
                </table>
            </div>
            
            <div class="metadata-section">
                <h3>Dateinamen-Konvention</h3>
                <ul>
                    <li><strong>Format:</strong> [U/W]_[Grenze]_[Beschreibung].xlsx</li>
                    <li><strong>Maximale L√§nge:</strong> 30 Zeichen</li>
                    <li><strong>Beispiele:</strong>
                        <ul>
                            <li>U_klimawandel_Temperatur.xlsx</li>
                            <li>W_biodiversitaet_Artenvielfalt.xlsx</li>
                            <li>U_suesswassernutzung_Verbrauch.xlsx</li>
                        </ul>
                    </li>
                </ul>
            </div>
            
            <div class="metadata-section">
                <h3>Validierungsregeln</h3>
                <ol>
                    <li><strong>Jahresangabe:</strong> Zwischen 1700 und 2100</li>
                    <li><strong>Mindestanzahl:</strong> Mindestens 5 Messwerte erforderlich</li>
                    <li><strong>Abstand:</strong> Zwischen Messwerten mindestens 10 Jahre</li>
                    <li><strong>Grenzwerte:</strong> M√ºssen definiert werden</li>
                </ol>
            </div>
            
            <div class="metadata-section">
                <h3>Formel</h3>
                <div class="formula-display">
                    Prozent = ((Messwert - Unterer_Grenzwert) / (Oberer_Grenzwert - Unterer_Grenzwert)) * 100
                </div>
            </div>
        </div>
        
        <div class="export-section">
            <h3>CSV-Export</h3>
            <button onclick="exportCSV()">Als CSV exportieren</button>
            <button onclick="validateData()">Daten validieren</button>
            <div id="validationResult"></div>
        </div>
    </div>

    <script>
        let selectedBoundary = null;
        let boundaryData = {
            'klimawandel': { name: 'Klimawandel', color: 'GELB', symbol: '‚òÄÔ∏è', hex: '#FFFF00' },
            'neue-substanzen': { name: 'Neue Substanzen', color: 'ROT', symbol: '‚öóÔ∏è', hex: '#FF0000' },
            'biodiversitaet': { name: 'Biodiversit√§t', color: 'GR√úN', symbol: 'üåø', hex: '#00FF00' },
            'suesswassernutzung': { name: 'S√º√üwassernutzung', color: 'BLAU', symbol: 'üíß', hex: '#0000FF' },
            'landnutzung': { name: 'Landnutzung', color: 'BRAUN', symbol: 'üåç', hex: '#8B4513' },
            'ozeanversauerung': { name: 'Ozeanversauerung', color: 'T√úRKIS', symbol: 'üêö', hex: '#00FFFF' },
            'ozonloch': { name: 'Ozonloch', color: 'LILA', symbol: 'üõ°Ô∏è', hex: '#800080' },
            'aerosole': { name: 'Aerosole', color: 'GRAU', symbol: '‚òÅÔ∏è', hex: '#808080' },
            'stickstoffkreislauf': { name: 'Stickstoffkreislauf', color: 'ORANGE', symbol: 'üå±', hex: '#FFA500' },
            'planetare-gesundheit': { name: 'Planetare Gesundheit', color: 'PINK', symbol: '‚ù§Ô∏è', hex: '#FF69B4' },
            'rohstoffe-ressourcen': { name: 'Rohstoffe & Ressourcen', color: 'SILBER', symbol: '‚õèÔ∏è', hex: '#C0C0C0' }
        };
        
        // Planetare Grenze ausw√§hlen
        function selectBoundary(boundary, color, symbol, name) {
            selectedBoundary = boundary;
            
            // Alle Karten zur√ºcksetzen
            document.querySelectorAll('.boundary-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Ausgew√§hlte Karte markieren
            event.target.closest('.boundary-card').classList.add('selected');
            
            // Dropdown aktualisieren
            document.getElementById('planetareGrenze').value = boundary;
            
            // Info anzeigen
            const info = document.getElementById('selectedBoundaryInfo');
            const details = document.getElementById('boundaryDetails');
            details.innerHTML = `
                <strong>${name}</strong><br>
                Symbol: ${symbol}<br>
                Farbe: ${color}<br>
                Hex-Code: ${boundaryData[boundary].hex}
            `;
            info.style.display = 'block';
        }
        
        // Farbe und Symbol aktualisieren
        function updateColorAndSymbol() {
            const boundary = document.getElementById('planetareGrenze').value;
            if (boundary && boundaryData[boundary]) {
                selectedBoundary = boundary;
                const data = boundaryData[boundary];
                
                // Alle Karten zur√ºcksetzen
                document.querySelectorAll('.boundary-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                // Ausgew√§hlte Karte markieren
                document.querySelector(`.${boundary}`).classList.add('selected');
                
                // Info aktualisieren
                const info = document.getElementById('selectedBoundaryInfo');
                const details = document.getElementById('boundaryDetails');
                details.innerHTML = `
                    <strong>${data.name}</strong><br>
                    Symbol: ${data.symbol}<br>
                    Farbe: ${data.color}<br>
                    Hex-Code: ${data.hex}
                `;
                info.style.display = 'block';
            }
        }
        
        // Tabellenblatt anzeigen
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // Messwerte-Tabelle initialisieren
        function initMesswerteTable() {
            const tbody = document.getElementById('messwerteBody');
            tbody.innerHTML = '';
            
            for (let year = 1700; year <= 2100; year += 10) {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${year}</td>
                    <td><input type="number" step="0.01" onchange="calculatePercentage(this, ${year})"></td>
                    <td class="prozent-cell"></td>
                    <td class="validation-cell"></td>
                `;
            }
        }
        
        // Prozentwert berechnen
        function calculatePercentage(input, year) {
            const messwert = parseFloat(input.value);
            const untererGrenzwert = parseFloat(document.getElementById('untererGrenzwert').value);
            const obererGrenzwert = parseFloat(document.getElementById('obererGrenzwert').value);
            
            const row = input.closest('tr');
            const prozentCell = row.querySelector('.prozent-cell');
            const validationCell = row.querySelector('.validation-cell');
            
            if (messwert && untererGrenzwert && obererGrenzwert) {
                const prozent = ((messwert - untererGrenzwert) / (obererGrenzwert - untererGrenzwert)) * 100;
                prozentCell.textContent = prozent.toFixed(2) + '%';
                
                if (year >= 1700 && year <= 2100) {
                    validationCell.textContent = 'OK';
                    validationCell.className = 'validation-cell validation-ok';
                } else {
                    validationCell.textContent = 'Jahr au√üerhalb 1700-2100';
                    validationCell.className = 'validation-cell validation-error';
                }
            } else {
                prozentCell.textContent = '';
                validationCell.textContent = '';
                validationCell.className = 'validation-cell';
            }
        }
        
        // Daten validieren
        function validateData() {
            const inputs = document.querySelectorAll('#messwerteBody input');
            let messwerteCount = 0;
            let errors = [];
            
            inputs.forEach((input, index) => {
                if (input.value) {
                    messwerteCount++;
                }
            });
            
            if (messwerteCount < 5) {
                errors.push('Mindestens 5 Messwerte erforderlich');
            }
            
            if (!document.getElementById('untererGrenzwert').value || !document.getElementById('obererGrenzwert').value) {
                errors.push('Grenzwerte m√ºssen definiert werden');
            }
            
            if (!document.getElementById('kurvenname').value) {
                errors.push('Kurvenname muss angegeben werden');
            }
            
            if (!document.getElementById('planetareGrenze').value) {
                errors.push('Planetare Grenze muss ausgew√§hlt werden');
            }
            
            const resultDiv = document.getElementById('validationResult');
            if (errors.length === 0) {
                resultDiv.innerHTML = '<div class="validation-ok">‚úÖ Alle Validierungen erfolgreich!</div>';
            } else {
                resultDiv.innerHTML = '<div class="validation-error">‚ùå Fehler: ' + errors.join(', ') + '</div>';
            }
        }
        
        // CSV exportieren
        function exportCSV() {
            const kurvenname = document.getElementById('kurvenname').value;
            const kurventyp = document.getElementById('kurventyp').value;
            const planetareGrenze = document.getElementById('planetareGrenze').value;
            const kurvenbeschreibung = document.getElementById('kurvenbeschreibung').value;
            const autoren = document.getElementById('autoren').value;
            const veroeffentlichungsdatum = document.getElementById('veroeffentlichungsdatum').value;
            const veroeffentlichungsort = document.getElementById('veroeffentlichungsort').value;
            const internetlink = document.getElementById('internetlink').value;
            const zusatzinfo = document.getElementById('zusatzinfo').value;
            const untererGrenzwert = document.getElementById('untererGrenzwert').value;
            const obererGrenzwert = document.getElementById('obererGrenzwert').value;
            
            const boundaryInfo = boundaryData[planetareGrenze] || {};
            
            let csv = `# Kurvenname: ${kurvenname}\n`;
            csv += `# Kurventyp: ${kurventyp === 'U' ? 'Ursache (gestrichelte Linie)' : 'Wirkung (durchgezogene Linie)'}\n`;
            csv += `# Planetare Grenze: ${boundaryInfo.name || planetareGrenze}\n`;
            csv += `# Farbe: ${boundaryInfo.color || ''}\n`;
            csv += `# Symbol: ${boundaryInfo.symbol || ''}\n`;
            csv += `# Kurvenbeschreibung: ${kurvenbeschreibung}\n`;
            csv += `# Autoren: ${autoren}\n`;
            csv += `# Ver√∂ffentlichungsdatum: ${veroeffentlichungsdatum}\n`;
            csv += `# Ver√∂ffentlichungsort: ${veroeffentlichungsort}\n`;
            csv += `# Internetlink: ${internetlink}\n`;
            csv += `# Zus√§tzliche Informationen: ${zusatzinfo}\n`;
            csv += `# Grenzwerte f√ºr diese Kurve\n`;
            csv += `# Unterer_Grenzwert: ${untererGrenzwert}\n`;
            csv += `# Oberer_Grenzwert: ${obererGrenzwert}\n`;
            csv += `# Formel: Prozent = ((Messwert - ${untererGrenzwert}) / (${obererGrenzwert} - ${untererGrenzwert})) * 100\n\n`;
            csv += `Jahr,Messwert,Prozent\n`;
            
            const inputs = document.querySelectorAll('#messwerteBody input');
            inputs.forEach((input, index) => {
                if (input.value) {
                    const year = 1700 + (index * 10);
                    const messwert = input.value;
                    const prozentCell = input.closest('tr').querySelector('.prozent-cell');
                    const prozent = prozentCell.textContent.replace('%', '');
                    csv += `${year},${messwert},${prozent}\n`;
                }
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${kurvenname}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }
        
        // Initialisierung beim Laden
        window.onload = function() {
            initMesswerteTable();
        };
    </script>
</body>
</html> 